{% macro form_field(field) -%}

    {% set with_label = kwargs.pop('with_label', True) %}
    {% set with_quantity = kwargs.pop('q', False) %}

    {% if field.errors %}
        <div class="alert alert-warning" role="alert">
            <b>Error:</b> {{ field.errors|join(', ') }}
        </div>
    {% endif %}

    {% if field.type == "BooleanField" %}
        <div class="form-group form-check" id="{{ field.id }}_div">
            <input class="form-check-input" id="{{ field.id }}" name="{{ field.id }}" type="checkbox">
            <label class="form-check-label" for="{{ field.id }}">
                {{ field.label.text }}
            </label>
        </div>
        {% elif field.type == "StringField" %}
            <div class="form-group" id="{{ field.id }}_div">
                <label for="{{ field.id }}">{{ field.label.text }}{% if field.flags.required %} <span class="imp">(*)</span>{% endif %}: </label>
                {% if with_quantity %}
                    <div class="input-group mb-2">
                        <div class="input-group-prepend">
                            <div class="input-group-text quantity-text"></div>
                        </div>
                        <input type="text" class="form-control" id="{{ field.id }}" name="{{ field.name }}"{% if field.flags.required %}required{% endif %}>
                    </div>
                {% else %}
                    <input type="text" class="form-control" id="{{ field.id }}" name="{{ field.name }}"{% if field.flags.required %}required{% endif %}>
                {% endif %}
            </div>
        {% elif field.type == "SelectField" %}
            <div class="form-group" id="{{ field.id }}_div">
                <label for="{{ field.id }}">{{ field.label.text }}: </label>
                <select class="form-control" id="{{ field.id }}" name="{{ field.name }}">
                    {% for value, key, bo in field.iter_choices() %}
                        <option value="{{ value }}">{{ key }}</option>
                    {% endfor %}
                </select>
            </div>
        {% elif field.type == "DateField" %}
            <div class="form-group" id="{{ field.id }}_div">
                <label for="{{ field.id }}">{{ field.label.text }}{% if field.flags.required %} <span class="imp">(*)</span>{% endif %}: </label>
                <input type="date" name="{{ field.name }}" id="{{ field.id }}" min="1000-01-01"
                   max="3000-12-31" class="form-control">
            </div>
        {% elif field.type == "TimeField" %}
            <div class="form-group" id="{{ field.id }}_div">
                <label for="{{ field.id }}">{{ field.label.text }}{% if field.flags.required %} <span class="imp">(*)</span>{% endif %}: </label>
                <input type="time" class="form-control"  id="{{ field.id }}" name="{{field.name}}" value="13:30" {% if field.flags.required %}required{% endif %} />
            </div>
        {% elif field.type == "RadioField" %}
            <div class="form-group" id="{{ field.id }}_div">
                <div class="col-form-label">
                    {{ field.label.text }}{% if field.flags.required %} <span class="imp">(*)</span>{% endif %}:
                </div>
            {% for key, value, bo in field.iter_choices() %}
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="{{ field.id }}" id="{{ field.id }}" value="{{ value }}" {% if loop.index == 1 %}checked{% endif %}>
                    <label class="form-check-label" for="{{ field.id }}">{{ value }}</label>
                </div>
            {% endfor %}
            </div>
        {% elif field.type == "PasswordField" %}
            <div class="form-group" id="{{ field.id }}_div">
                <label for="{{ field.id }}">{{ field.label.text }}{% if field.flags.required %} <span class="imp">(*)</span>{% endif %}: </label>
                <input type="password" class="form-control" id="{{ field.id }}" name="{{ field.name }}" required>
            </div>
        {% elif field.type == "FileField" %}
            <div class="form-group" id="{{ field.id }}_div">
                <label for="{{ field.id }}">{{ field.label.text }}{% if field.flags.required %} <span class="imp">(*)</span>{% endif %}: </label>
                <input type="file" class="form-control-file" id="{{ field.id }}" name="{{ field.name }}"
                   {% if field.flags.required %}required{% endif %}>
            </div>
        {% elif field.type == "IntegerField" %}
            <div class="form-group" id="{{ field.id }}_div">
                <label for="{{ field.id }}">{{ field.label.text }}{% if field.flags.required %} <span class="imp">(*)</span>{% endif %}: </label>
                <input type="number" class="form-control" id="{{ field.id }}" name="{{ field.name }}" min="1"
                   {% if field.flags.required %}value="1" required{% endif %}>
            </div>
        {% elif field.type == "SubmitField" %}
            <div class="form-group" id="{{ field.id }}_div">
                <button type="submit" class="btn btn-success float-right" id="{{ field.id }}">
                    <i class="fa fa-check"></i> {{ field.label.text }}
                </button>
            </div>
        {% endif %}

{%- endmacro %}


{% macro show_value(attribute, label, type) -%}
    <div class="form-group row">
        <label class="col-4 col-form-label text-muted">{{ label }}:</label>
        <div class="col-8">
            {% if type == "text" %}
                <p class="col-sm-4">{{ attribute }}</p>
            {% elif type == "textarea" %}
                <p class="col-sm-4">{{ attribute }}</p>
            {% elif type == "enum" %}
                <p class="col-sm-4">{{ attribute.value }}</p>
            {% elif type == "boolean" %}
                {{ attribute }}
            {% elif type == "datetime" %}
                <p class="col-sm-4">{{ attribute.strftime('%Y-%m-%d') }}</p>
            {% endif %}

        </div>
    </div>

{%- endmacro %}

{% macro new_render_form(form) -%}
    {% for element in form %}
        {% if (element.type != "CSRFTokenField") %}
            {{ form_field(element) }}
        {% endif %}
    {% endfor %}
{%- endmacro %}

{% macro render_warning(title, description, button_url, button_text, add, refresh) -%}
<div class="jumbotron jumbotron-fluid">
  <div class="container text-center">
    <h4><i class="fa fa-exclamation-triangle"></i> {{ title }}</h4>
      {% for line in description %}
          <p>{{ line }}</p>
      {% endfor %}
        <a href="{{ url_for( button_url )}}" {% if refresh %}target="_blank"{% endif %}>
            <div class="btn btn-primary">
                {% if add %}<i class="fa fa-plus"></i>{% endif %} {{ button_text }}
            </div>
        </a>
        {% if refresh %}
            <p><i class="fa fa-sync top10"></i> Please refresh this page when completed</p>
        {% endif %}
  </div>
</div>
{%- endmacro %}

{% macro render_progress(now, max) -%}

<div class="progress">
        <div class="progress-bar" role="progressbar" style="width: {{ (now/max)*100 }}%" aria-valuenow="{{ now }}" aria-valuemin="0" aria-valuemax="{{ max }}"></div>
</div>

{%- endmacro %}

{% macro render_success(title, description) -%}
    <div class="jumbotron jumbotron-fluid" style="background-color: #28a745; color: #fff;">
        <div class="container text-center">
            <h4><i class="fa fa-check-circle"></i></h4>
            <h4>{{ title }}</h4>
              <p>{{ description }}</p>

        </div>
    </div>
{%- endmacro %}

{% macro render_question(field, count) -%}
    <div class="list-group-item flex-column align-items-start">
        <div class="d-flex w-100 justify-content-between">
            <h5 class="mb-1">Question {{ count+1 }}</h5>
            <small>
                <input class="form-check-input" id="{{ field.id }}" name="{{ field.id }}" type="checkbox">
            </small>
        </div>
        <p class="mb-1">{{ field.label.text }}</p>
    </div>
{%- endmacro %}


{% macro generate_attribute_select_form(form) -%}

    <table id="selectAttribute" class="table table-striped table-bordered" style="width:100%">
        <thead>
        <tr>
            <th>Attribute Term</th>
            <th>Type</th>
            <th>Required</th>
            <th>Select</th>
        </tr>
        </thead>
        <tbody>
        {% for field in form %}
            {% if field.type == "BooleanField" %}
                <tr>
                    <td>{{ field.label }}</td>
                    <td>{{ field.__dict__ }}</td>
                    <td>{{ field.data }}</td>
                    <td>{{ field }}</td>
                </tr>
            {% endif %}
        {% endfor %}
        </tbody>
    </table>
{%- endmacro %}